## Stored Procedure (스토어드 프로시저)
>프로시저란 특정한 작업을 수행하는 SQL문을 논리적으로 그룹화한 것을 말한다.<BR>프로시저는 그 자체만으로도 완전한 프로그램의 축소판이라고 할 수 있다.
- 스토어드 프로시저는 연속된 SQL문들을 하나로 모아 SQL 서버에 미리 컴파일해서 저장해 놓은것을 말한다.
    - 클라이언트로부터 호출문을 통해 복잡한 SQL의 일괄 작업을 수행하는데 적합하다.
- **스토어드 프로시저의 구성**
    - 선언부 : 타입, 커서, 상수, 변수, 내포된 서브 프로그램을 선언하는 부분
    - 실행부 : 코드 실행을 제어하고 데이터를 조작하는 문장들을 작성하는 부분
    - 예외처리부 : 스토어드 프로시저 실행중에 발생하는 예외를 처리하는 부분

### 스토어드 프로시저의 장점
- **모듈별 프로그래밍 허용**
    - 스토어드 프로시저를 한번만 만들어 데이터베이스에 저장한 후<BR>여러 프로그램에서 계속해서 스토어드 프로시저를 호출하여 사용할 수 있다.
    - 스토어드 프로시저는 데이터베이스 프로그래머가 만들며 원본 코드와 상관없이 수정할 수 있다.
- **빠른 SQL 실행 시간**
    - 스토어드 프로시저는 만들어질 때 구문이 분석되고 최적화된다.
    - 한번 실행된 후에는 메모리에 캐시되어 다음 실행에서는 빠르게 실행될 수 있다.
- **보안성 향상**
    - 사용자가 스토어드 프로시저를 통해서만 데이터에 접근할 수 있도록 사용자에 대한 데이터베이스 접근 권한을 제한할 수 있다.
- **네트워크 통신량 감소**
    - 응용 프로그램에서는 수백 줄의 SQL 코드를 필요로하는 작업을 네트워크로 보내지 않고 <BR>스토어드 프로시저를 실행하는 하나의 명령문만을 보내서 동일한 작업을 수행할 수 있다.

### 스토어드 프로시저 생성
>스토어드 프로시저를 생성하기 위해서는 CREATE PROCEDURE 명령어를 사용한다.
- **표기형식**
    ```sql
    -- 인수 없는 프로시저
    CREATE [OR REPLACE] 프로시저_명
    IS
    [
        변수이름 데이터타입; --프로시저 내에서 사용할 지역변수 선언
        ..
    ]
    BEGIN
        기능구현;
    END;
    / --실행보다는 저장한다는 의미

    -- 인수 있는 프로시저
    CREATE [OR REPLACE] PROCEDURE 프로시저_명(
    변수이름 IN 데이터타입, 변수이름 IN 데이터아입 ... --IN 생략가능
    )
    IS
    [
        변수이름 데이터타입; --프로시저 내에서 사용할 지역변수 선언
        ..
    ]
    BEGIN
        기능구현;
    END;
    / -- 실행보다는 저장한다는 의미 
    ```
    - OR REPLACE: 선택적인(Optional) 예약어, 사용시 동일한 스토어드 프로시저 이름이 이미 존재하는 경우 기존의 것을 대체함
    - 프로시저명: 생성하려는 스토어드 프로시저의 이름
    - 파라미터
        - IN: 호출되는 스토어드 프로시저에 값을 전달하는 것을 지정(**내부에서 쓰일 변수**)
        - OUT: 스토어드 프로시저가 그 호출 프로그램에게 값을 반환한다는 것을 지정(**외부에서쓰일 변수**)
            - 프로시저 실행 시점에 OUT 매개변수를 변수 형태로 전달하고 프로시저 실행부에서 이 매개변수에 특정값을 할당.
        - INOUT: 스토어드 프로시저에 값을 전달하고, 스토어드 프로시저 실행 후 호출 프로그램에 값을 반환해야 한다는 것을 지정
            - 내부에서 대입된 함수와 동시에 해당 변수를 리턴
    - 프로시저 BODY: 스토어드 프로시저의 본문 코드를 기록하는 부분
        - BEGIN으로 시작해서 END로 끝나는데, 적어도 하나의 SQL문이 있어야 한다.
        - 변수에 값을 치환할 때는 예약어 SET을 사용
    - EX:)
    ```sql
    CREATE OR REPLACE PROCEDURE emp_change_s(IN i_사원번호 integer)
    BEGIN
        UPDATE 급여
        SET 지급방식 = 'S'
        WHERE 사원번호 = i_사원번호;
    END;
    ```
### 스토어드 프로시저 제거
>스토어드 프로시저를 제거하려면 DROP PROCEDURE 명령어를 사용한다.
- **표기형식** : ``` DROP PROCEDURE 프로시저명; ```
- 스토어드 프로시저를 제거하면 다시 되돌릴 수 없다.

### 스토어드 프로시저 실행
>스토어드 프로시저를 실행하기 위해서는 EXECUTE 명령어 또는 줄여서 EXEC 명령어를 사용한다.
- **표기형식**
    - ``` EXECUTE 프로시저명;```
    - ``` EXEC 프로시저명; ```
